# 1行コード変換ゲーム - システム仕様

## 1. システム概要

冗長なRubyコードを短く書き直す力を養うゲームアプリケーション。
お題として冗長なコードが提示され、ユーザーはそれを短いコードに書き換えて提出する。
提出されたコードは自動的に評価され、期待する出力と一致すれば成功となる。

## 2. 機能一覧

### 実装済み機能
- お題一覧・詳細表示
- 回答提出フォーム
- 提出コードの自動評価
- 合否判定と結果表示
- LLM APIを使った問題自動生成
- エラーログの保存
- 問題コードの実行による期待出力の自動計算
- 問題コード中の変数・メソッドをユーザーコード評価時に反映
- エラー表示の改善（簡潔なメッセージ、固定サイズ表示）
- 戻り値のフィードバック表示
- 問題コードからの変数・メソッド抽出とヒント表示

### 次期開発予定
- ユーザー登録・認証
- スコア・ランキング
- 問題タグ付け機能
- 問題投稿・共有機能

## 3. 技術スタック

- **フレームワーク**: Ruby on Rails
- **データベース**: SQLite（開発環境）
- **テスト**: RSpec
- **コード評価**: 安全なevalとタイムアウト機能
- **問題生成**: Groq API（LLM）

## 4. セキュリティ対策

### コード評価の安全性
- タイムアウト機能で無限ループを防止
- エラー種別の詳細な分類と記録
- 将来的にはDocker隔離実行を検討

### API認証
- 環境変数による認証情報管理
- .envファイルによる設定分離

## 5. データモデル

- **Problem**: お題情報（タイトル、説明、初期コード、期待出力）
- **Answer**: 回答情報（提出コード、結果、出力、エラーログ）
